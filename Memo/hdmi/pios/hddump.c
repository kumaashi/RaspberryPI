/*
root@raspberrypi:~# ./a.out > res_outhd.txt
root@raspberrypi:~# cat res_outhd.txt

0x20808000 : 0x68646D69
0x20808004 : 0x68646D69
0x20808008 : 0x68646D69
0x2080800C : 0x00000201
0x20808010 : 0x68646D69
0x20808014 : 0x00000400
0x20808018 : 0x08080608
0x2080801C : 0x00020700
0x20808020 : 0x68646D69
0x20808024 : 0x00000000
0x20808028 : 0x68646D69
0x2080802C : 0x0D0489A6
0x20808030 : 0x68646D69
0x20808034 : 0x68646D69
0x20808038 : 0x401C0000
0x2080803C : 0x68646D69
0x20808040 : 0x0000002F
0x20808044 : 0x00000000
0x20808048 : 0x010006E0
0x2080804C : 0x06E00000
0x20808050 : 0x01000000
0x20808054 : 0x000006E0
0x20808058 : 0x01000000
0x2080805C : 0x68646D69
0x20808060 : 0x68646D69
0x20808064 : 0x68646D69
0x20808068 : 0x00008EB8
0x2080806C : 0x68646D69
0x20808070 : 0x68646D69
0x20808074 : 0x68646D69
0x20808078 : 0x68646D69
0x2080807C : 0x68646D69
0x20808080 : 0x68646D69
0x20808084 : 0x68646D69
0x20808088 : 0x68646D69
0x2080808C : 0x00000201
0x20808090 : 0x68646D69
0x20808094 : 0x00000400
0x20808098 : 0x08080608
0x2080809C : 0x00020700
0x208080A0 : 0x68646D69
0x208080A4 : 0x00000000
0x208080A8 : 0x68646D69
0x208080AC : 0x0D0489A6
0x208080B0 : 0x68646D69
0x208080B4 : 0x68646D69
0x208080B8 : 0x401C0000
0x208080BC : 0x68646D69
0x208080C0 : 0x0000002F
0x208080C4 : 0x00000000
0x208080C8 : 0x010006E0
0x208080CC : 0x06E00000
0x208080D0 : 0x01000000
0x208080D4 : 0x000006E0
0x208080D8 : 0x01000000
0x208080DC : 0x68646D69
0x208080E0 : 0x68646D69
0x208080E4 : 0x68646D69
0x208080E8 : 0x00008EB8
0x208080EC : 0x68646D69
0x208080F0 : 0x68646D69
0x208080F4 : 0x68646D69
0x208080F8 : 0x68646D69
0x208080FC : 0x68646D69
*/
#include <stdio.h>
#include <unistd.h>
#include <sys/mman.h>
#include <stdint.h>
#include <fcntl.h>
#include <errno.h>
#include <stdlib.h>
#include <string.h>
#include <malloc.h>
#include <limits.h>
#include <signal.h>
#include <unistd.h>
#include <sys/uio.h>
#include <sys/mman.h>

//https://github.com/raspberrypi/linux/blob/rpi-5.10.y/drivers/gpu/drm/vc4/vc4_hdmi.c#L1953
//#define BASE_ADDR 0x20902000 //HDMI
#define BASE_ADDR 0x20808000 //HD

int main() {
	int mem_fd = open("/dev/mem", O_RDWR | O_SYNC);
	void *map_base = mmap(NULL,
			4096,
			PROT_READ | PROT_WRITE,
			MAP_SHARED,
			mem_fd,
			BASE_ADDR);
	uint32_t *start_addr = (uint32_t *)map_base;
	uint32_t *virt_addr = (uint32_t *)map_base;

	for(int i = 0 ; i < 0x100 / 4; i++) {
		printf("\n0x%08X : ", BASE_ADDR + (virt_addr - start_addr) * 4);
		printf("0x%08X ", *virt_addr);
		virt_addr++;
	}
	printf("\n");
	return 0;
}
